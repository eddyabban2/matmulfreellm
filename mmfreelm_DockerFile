FROM nvidia/cuda:12.4.1-devel-ubuntu22.04


RUN apt-get update -y && apt-get upgrade -y && apt-get install -y gdb git build-essential vim
RUN apt install -y python3 python3-pip
RUN pip install --upgrade pip setuptools wheel packaging
RUN pip install torch --index-url https://download.pytorch.org/whl/cu124
RUN pip install numpy
RUN pip install transformers==4.46.0
RUN pip install einops
RUN pip install triton==2.2
# RUN pip install -U git+https://github.com/ridgerchu/matmulfreellm

COPY . /matmulfreellm
WORKDIR /matmulfreellm

USER root